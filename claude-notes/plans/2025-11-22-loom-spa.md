# Loom - Project Plan

## Overview

Build a modern Single Page Application (SPA) for visualizing and managing beads issue databases. Loom provides a rich interface for teams managing coding agents and tracking work - a place where the threads of your work come together.

## Core Features

### 1. Issue Management

- View all issues in various layouts (list, board, tree)
- Create, update, and close issues
- Filter by status, priority, type, labels
- Search across titles and descriptions
- Bulk operations on multiple issues

### 2. Dependency Visualization

- Interactive dependency graph visualization
- Tree view for parent-child relationships
- Visual indication of blocking dependencies
- Highlight ready work (no blockers)

### 3. Board Views

- Kanban board grouped by status
- Priority-based views
- Assignee-based views (if we add assignee support)
- Custom board configurations

### 4. Analytics & Insights

- Velocity tracking
- Burndown charts
- Distribution by type/priority
- Time to completion metrics

### 5. Real-time Sync

- Watch `.beads/issues.jsonl` for changes
- Auto-refresh when file updates
- Optional: bidirectional sync with CLI

## Technical Architecture

### Frontend Stack

- **Framework**: React with TypeScript (modern, good ecosystem)
- **Build Tool**: Vite (fast, great DX)
- **State Management**: Zustand (lightweight, simple)
- **Server State**: TanStack Query (for issue data, caching, real-time sync)
- **Routing**: React Router
- **UI Components**: shadcn/ui (accessible, customizable)
- **Styling**: Tailwind CSS
- **Graph Visualization**: D3.js (with option for specialized layout libraries)
- **Data Grid**: TanStack Table

### Backend/Data Layer

- **Option A**: Pure static SPA reading `.beads/issues.jsonl`
  - Use File System Access API (Chrome/Edge)
  - Or: User selects file, app reads it
  - Pros: No server needed, simple deployment
  - Cons: Limited to local filesystem, no real-time sync

- **Option B**: Electron app
  - Full filesystem access
  - Can watch files for changes
  - Can execute `bd` commands
  - Pros: Best integration, native feel
  - Cons: Heavier, more complex build

- **Option C**: Web app + local server
  - Small Node.js/Rust server watching `.beads/` directory
  - WebSocket for real-time updates
  - REST API proxying to `bd` CLI
  - Pros: Good balance, works in browser
  - Cons: Requires running server

**Recommendation**: Start with Option C - provides best balance of features and complexity.

### Data Model

```typescript
interface Issue {
  id: string;
  title: string;
  description: string;
  status: 'open' | 'in_progress' | 'blocked' | 'closed';
  priority: 0 | 1 | 2 | 3 | 4;
  issue_type: 'bug' | 'feature' | 'task' | 'epic' | 'chore';
  labels: string[];
  created_at: string;
  updated_at: string;
  closed_at?: string;
  dependencies?: Dependency[];
}

interface Dependency {
  type: 'blocks' | 'related' | 'parent-child' | 'discovered-from';
  target_id: string;
}
```

## Project Structure

```
loom/
├── server/           # Local backend server
│   ├── src/
│   │   ├── server.ts    # Express/Fastify server
│   │   ├── watcher.ts   # File watcher for .beads/
│   │   └── bd-cli.ts    # CLI wrapper
│   └── package.json
├── web/              # React frontend
│   ├── src/
│   │   ├── components/  # React components
│   │   ├── hooks/       # Custom hooks
│   │   ├── lib/         # Utilities
│   │   ├── stores/      # State management (Zustand)
│   │   ├── types/       # TypeScript types
│   │   └── App.tsx
│   ├── public/
│   └── package.json
└── shared/           # Shared types/utils
    └── types.ts
```

## Development Phases

### Phase 1: Foundation

1. Set up project structure (monorepo with pnpm workspaces)
2. Initialize server with file watcher
3. Initialize React app with Vite
4. Set up WebSocket connection
5. Load and display basic issue list

### Phase 2: Core Features

1. Issue list with filtering and sorting
2. Issue detail view with edit capabilities
3. Create new issues
4. Update issue status
5. Add/remove labels

### Phase 3: Advanced Views

1. Kanban board view
2. Dependency graph visualization
3. Tree view for hierarchies
4. Ready work queue view

### Phase 4: Polish

1. Analytics dashboard
2. Search functionality
3. Keyboard shortcuts
4. Dark mode
5. Export/import capabilities

### Phase 5: Optional Enhancements

1. Multiple workspace support
2. Custom views and saved filters
3. Markdown preview for descriptions
4. Activity timeline
5. CLI integration (run bd commands from UI)
